<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>CaffeineClash.com.vn</title>
  <style>
    body {
      margin: 0;
      font-family: "Segoe UI", sans-serif;
      background-color: #f5f0e6;
      color: #4e342e;
    }

    .header {
      padding: 20px;
      background-color: #d7ccc8;
      display: flex;
      justify-content: space-between;
      align-items: center;
    }

    .logo {
      font-weight: bold;
      font-size: 1.2rem;
    }

    .section {
      padding: 40px 20px;
    }

    .flex-row, .flex-row-reverse {
      display: flex;
      justify-content: space-between;
      align-items: center;
      gap: 30px;
      flex-wrap: wrap;
    }

    .flex-row-reverse {
      flex-direction: row-reverse;
    }

    .flex-text {
      flex: 1;
      font-size: 1.4rem;
      min-width: 250px;
    }

    .flex-img {
      flex: 1;
      min-width: 250px;
      max-width: 500px;
    }

    .flex-img img {
      width: 100%;
      border-radius: 12px;
      box-shadow: 0 4px 10px rgba(0,0,0,0.15);
      margin-top: 10px;
    }

    .button-container {
      text-align: center;
      margin-top: 40px;
    }

    .game-button {
      padding: 15px 30px;
      font-size: 1.1rem;
      border: none;
      border-radius: 8px;
      background-color: #a1887f;
      color: white;
      cursor: pointer;
      transition: 0.3s;
    }

    .game-button:hover {
      background-color: #8d6e63;
    }

    .game-board {
      display: grid;
      grid-template-columns: repeat(6, 120px);
      gap: 15px;
      justify-content: center;
      margin: 40px auto;
      perspective: 1000px;
    }

    .card {
      width: 100px;
      height: 100px;
      background-color: #a1887f;
      border-radius: 10px;
      transform-style: preserve-3d;
      transition: transform 0.6s;
      position: relative;
      cursor: pointer;
    }

    .card.flipped {
      transform: rotateY(180deg);
    }

    .face {
      position: absolute;
      width: 100%;
      height: 100%;
      backface-visibility: hidden;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 16px;
      border-radius: 10px;
    }

    .front {
      background-color: #a1887f;
    }

    .back {
      transform: rotateY(180deg);
      background-color: #fffde7;
      color: #4e342e;
      font-weight: bold;
    }

    footer {
      padding: 20px;
      text-align: center;
      font-size: 0.9rem;
      color: #795548;
    }
  </style>
</head>
<!-- Firebase Auth + Firestore Leaderboard -->
<script type="module">
  import { initializeApp } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js";
  import { getAuth, GoogleAuthProvider, signInWithPopup, onAuthStateChanged } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-auth.js";
  import { getFirestore, doc, getDoc, setDoc, updateDoc, collection, query, orderBy, limit, onSnapshot } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore.js";

  // Firebase config b·∫°n cung c·∫•p
  const firebaseConfig = {
    apiKey: "AIzaSyCvzWN3TaOzVqfnmydlLAciY5Ps1NNA4-s",
    authDomain: "caffeineclash.firebaseapp.com",
    projectId: "caffeineclash",
    storageBucket: "caffeineclash.firebasestorage.app",
    messagingSenderId: "6327467073",
    appId: "1:6327467073:web:94a629f6d14a11aa01dac0",
    measurementId: "G-P87RYKDMDT"
  };

  // Init Firebase
  const app = initializeApp(firebaseConfig);
  const auth = getAuth(app);
  const db = getFirestore(app);

  // T·∫°o n√∫t ƒëƒÉng nh·∫≠p
  const loginBtn = document.createElement("button");
  loginBtn.className = "game-button";
  loginBtn.innerText = "üîê ƒêƒÉng nh·∫≠p b·∫±ng Gmail";
  loginBtn.onclick = async () => {
    const provider = new GoogleAuthProvider();
    await signInWithPopup(auth, provider);
  };

  // G√°n l·∫°i n√∫t ch∆°i c≈©
  const playBtn = document.querySelector(".game-button");
  playBtn.style.display = "none";
  playBtn.id = "playBtn";

  // T·∫°o khu v·ª±c leaderboard
  const leaderboardSection = document.createElement("div");
  leaderboardSection.className = "section";
  leaderboardSection.id = "leaderboardSection";
  leaderboardSection.style.display = "none";
  leaderboardSection.innerHTML = `
    <h2 style="text-align:center;">üèÜ B·∫£ng x·∫øp h·∫°ng</h2>
    <ol id="leaderboard" style="font-size:1.2rem; text-align:center;"></ol>
  `;
  document.body.insertBefore(leaderboardSection, document.querySelector("footer"));

  // G·∫Øn login button v√†o DOM
  document.querySelector(".button-container").prepend(loginBtn);

  let user = null;
  let userPoints = 0;

  // Sau khi ƒëƒÉng nh·∫≠p
  onAuthStateChanged(auth, async (currentUser) => {
    if (!currentUser) return;
    user = currentUser;
    loginBtn.style.display = "none";
    playBtn.style.display = "inline-block";
    leaderboardSection.style.display = "block";

    const userRef = doc(db, "users", user.uid);
    const snap = await getDoc(userRef);
    if (!snap.exists()) {
      await setDoc(userRef, { name: user.displayName, points: 0 });
    } else {
      userPoints = snap.data().points;
    }
    loadLeaderboard();
  });

  // Load top 10 ng∆∞·ªùi d√πng
  function loadLeaderboard() {
    const q = query(collection(db, "users"), orderBy("points", "desc"), limit(10));
    onSnapshot(q, (snapshot) => {
      const list = document.getElementById("leaderboard");
      list.innerHTML = "";
      snapshot.forEach((doc) => {
        const d = doc.data();
        list.innerHTML += `<li>${d.name}: ${d.points} ƒëi·ªÉm</li>`;
      });
    });
  }

  // B·∫Øt ƒë·∫ßu game khi ƒë√£ ƒëƒÉng nh·∫≠p
  document.getElementById("playBtn").onclick = () => {
    document.getElementById("minigame").style.display = "block";
    initBoard();
    document.getElementById("minigame").scrollIntoView({ behavior: "smooth" });
  };

  // C·∫≠p nh·∫≠t bi·ªÉu t∆∞·ª£ng m·ªõi
  const icons = [
    "matcha latte üçµ", "cafe ‚òï", "milk üç∂", "soda ü•§",
    "Ren chi·∫øn üò§", "Ren n·ªï n√£o ü§Ø", "Ren Luxury üòé", "Ren k√™u ng·∫°o üòè", "game üéÆ", "card üé¥", "Ren kh√≥c üò≠", "Ren chill üòó"
  ];
  let board = [], flipped = [], locked = false;

  function shuffle(array) {
    return array.sort(() => Math.random() - 0.5);
  }

  function initBoard() {
    board = shuffle([...icons, ...icons]);
    const container = document.getElementById('gameBoard');
    container.innerHTML = '';
    flipped = [];
    board.forEach((text, index) => {
      const card = document.createElement('div');
      card.classList.add('card');
      card.dataset.index = index;

      card.innerHTML = `
        <div class="face front"></div>
        <div class="face back">${text}</div>
      `;
      card.addEventListener('click', () => handleFlip(card));
      container.appendChild(card);
    });
  }

  async function handleScore(pointsEarned) {
  userPoints += pointsEarned;
  console.log(`üíæ C·ªông ${pointsEarned} ƒëi·ªÉm ‚Üí T·ªïng: ${userPoints}`);

  try {
    await updateDoc(doc(db, "users", user.uid), { points: userPoints });
    alert(`‚úÖ B·∫°n nh·∫≠n ƒë∆∞·ª£c ${pointsEarned} ƒëi·ªÉm! T·ªïng ƒëi·ªÉm: ${userPoints}`);
    loadLeaderboard();
  } catch (err) {
    console.error("‚ùå L·ªói khi c·∫≠p nh·∫≠t ƒëi·ªÉm:", err);
    alert("‚ùå L·ªói khi l∆∞u ƒëi·ªÉm v√†o h·ªá th·ªëng! Xem console.");
  }
}

  function handleFlip(card) {
  if (locked || card.classList.contains('flipped')) return;
  card.classList.add('flipped');
  flipped.push(card);

  if (flipped.length === 2) {
    locked = true;
    const [a, b] = flipped;
    const valA = a.querySelector('.back').textContent;
    const valB = b.querySelector('.back').textContent;

    if (valA === valB) {
      flipped = [];
      locked = false;

      // N·∫øu l·∫≠t h·∫øt t·∫•t c·∫£ c·∫∑p ƒë√∫ng
      if (document.querySelectorAll('.card.flipped').length === board.length) {
        handleScore(10);
        setTimeout(() => {
          if (confirm("üéâ B·∫°n ƒë√£ th·∫Øng! Ch∆°i l·∫°i?")) {
            initBoard(); // ch·ªâ shuffle l·∫°i khi th·∫Øng
          }
        }, 500);
      }

    } else {
      setTimeout(() => {
        document.getElementById("boing-sound").play();

        // ‚ùó‚ùó L·∫≠t √∫p to√†n b·ªô c√°c th·∫ª (k·ªÉ c·∫£ ƒë√∫ng)
        document.querySelectorAll('.card').forEach(c => c.classList.remove('flipped'));

        const correct = document.querySelectorAll('.card.flipped').length; // l√∫c n√†y = 0

        setTimeout(() => {
          // Ch·∫•m ƒëi·ªÉm theo y√™u c·∫ßu
          if (correct >= 8) {
            handleScore(1);
          } else {
            handleScore(0);
          }
          flipped = [];
          locked = false;
        }, 300);
      }, 800);
    }
  }
}

</script>

<body>

  <div class="header">
    <div class="logo">CaffeineClash.com.vn ‚òïüéÆ</div>
  </div>

  <!-- SECTION 1 -->
  <div class="section flex-row">
    <div class="flex-text">
      <h2>‚òï Welcome to Caffeine Clash!</h2>
<p>
  ·∫®n m√¨nh gi·ªØa l√≤ng th√†nh ph·ªë t·∫•p n·∫≠p, <strong>Caffeine Clash</strong> kh√¥ng ch·ªâ l√† m·ªôt qu√°n caf√©,  
  m√† l√† n∆°i h·ªôi t·ª• c·ªßa nh·ªØng t√¢m h·ªìn y√™u t·ªëc ƒë·ªô, tr√≠ tu·ªá v√† caffeine.  
  T·∫°i ƒë√¢y, m·ªói ng·ª•m latte l√† m·ªôt l·∫ßn tƒÉng mana, v√† m·ªói b√†n ƒë·∫•u b√†i l√† m·ªôt v≈© tr·ª• chi·∫øn thu·∫≠t ƒëang ch·ªù ƒë∆∞·ª£c khai m·ªü.
</p>
<p>
  D√π b·∫°n l√† ng∆∞·ªùi m·ªõi ch·ªâ v·ª´a bi·∫øt ƒë·∫øn ‚Äútapping mana‚Äù hay l√† chi·∫øn th·∫ßn combo 999 hit,  
  ch√∫ng t√¥i c√≥ kh√¥ng gian d√†nh ri√™ng cho b·∫°n: n∆°i ly c√† ph√™ n√≥ng v√† nh·ªØng tr·∫≠n ƒë·∫•u n·∫£y l·ª≠a h√≤a v√†o nhau nh∆∞ m·ªôt ngh·ªá thu·∫≠t.
</p>
    </div>
    <div class="flex-img">
      <img src="so-1.jpg.jpg" alt="so 1">
    </div>
  </div>

  <!-- SECTION 2 -->
  <div class="section flex-row-reverse">
    <div class="flex-text">
      <h2>üéÆ M·ªôt s·ª± k·∫øt h·ª£p ƒë·ªôc ƒë√°o</h2>
<p>
  <strong>Ch√∫ng t√¥i tin r·∫±ng kh√¥ng gian gi·∫£i tr√≠ hi·ªán ƒë·∫°i kh√¥ng c·∫ßn ph·∫£i t√°ch bi·ªát gi·ªØa ch∆°i v√† chill.</strong>  
  V√¨ v·∫≠y, Caffeine Clash t·∫°o ra m·ªôt h·ªá sinh th√°i n∆°i game th·ªß c√≥ th·ªÉ v·ª´a nh√¢m nhi m·ªôt ly soda m√°t l·∫°nh,  
  v·ª´a ‚Äúc√† kh·ªãa‚Äù nhau tr√™n m√°y th√πng ƒë·ªëi kh√°ng v·ªõi b·∫°n b√®.
</p>

<p>
  T·ª´ th·∫ª b√†i l·∫•p l√°nh, b√†n tay shuffle ƒëi√™u luy·ªán, ƒë·∫øn c√∫ ƒë√° roundhouse v√¥ c·ª±c trong Street Fighter‚Ä¶  
  t·∫•t c·∫£ ƒë·ªÅu di·ªÖn ra t·∫°i m·ªôt n∆°i ‚Äî n∆°i m√† m·ªói chi·∫øn th·∫Øng ƒë·ªÅu ƒë∆∞·ª£c ch√∫c m·ª´ng b·∫±ng... m·ªôt shot espresso.  
  B·∫°n ƒë√£ s·∫µn s√†ng l√™n level ch∆∞a?
</p>

<p>
  üí• <strong>S·∫Øp t·ªõi khi ƒëi v√†o v·∫≠n h√†nh ch√≠nh th·ª©c, Caffeine Clash s·∫Ω t·ªï ch·ª©c s·ª± ki·ªán m·ªü m√†n ho√†nh tr√°ng mang t√™n:</strong>  
  <em>**‚ÄúCaffeine Showdown Vol.1‚Äù**</em> ‚Äî m·ªôt gi·∫£i ƒë·∫•u k·∫øt h·ª£p gi·ªØa **card game chi·∫øn thu·∫≠t** v√† **fighting game arcade** l·∫ßn ƒë·∫ßu ti√™n xu·∫•t hi·ªán t·∫°i th√†nh ph·ªë!
</p>

<p>
  Ng∆∞·ªùi ch∆°i s·∫Ω v·ª´a thi ƒë·∫•u Magic: The Gathering, Pok√©mon TCG, ho·∫∑c Yugioh‚Ä¶  
  r·ªìi chuy·ªÉn sang combo Zangief v√† Ryu ·ªü khu v·ª±c m√°y th√πng ƒë·ªëi kh√°ng c·ª±c ch√°y!  
  M·ªói chi·∫øn th·∫Øng ·ªü t·ª´ng v√≤ng s·∫Ω ƒë∆∞·ª£c c·ªông ƒëi·ªÉm t√≠ch l≈©y ƒë·ªÉ x·∫øp h·∫°ng tranh c√∫p **Champion of Caffeine** üèÜ
</p>

<p>
  üéÅ V√† t·∫•t nhi√™n, kh√¥ng th·ªÉ thi·∫øu c√°c ph·∫ßn th∆∞·ªüng: √°o ƒë·∫•u ƒë·ªôc quy·ªÅn, ly s·ª© in t√™n v√¥ ƒë·ªãch, v√† c·∫£...  
  **"Phi·∫øu vƒ©nh vi·ªÖn u·ªëng cafe mi·ªÖn ph√≠ 1 nƒÉm"** cho qu√°n qu√¢n to√†n nƒÉng! üò±‚òï  
  (*Ren c√≤n g·ª£i √Ω: ai cosplay Bartender ho·∫∑c nh√¢n v·∫≠t trong game s·∫Ω ƒë∆∞·ª£c buff ƒëi·ªÉm th∆∞·ªüng n√® üòÜ*)
</p>
    </div>
    <div class="flex-img">
      <img src="so-2.jpg.jpg" alt="so 2">
      <img src="so-3.jpg.jpg" alt="so 3">
    </div>
  </div>

  <!-- GAME INTRO -->
  <div class="section">
    <h3 style="text-align: center;">üéâ C·∫£m ∆°n b·∫°n ƒë√£ gh√© qua Caffeine Clash!</h3>
    <p style="text-align: center;">V√† b√¢y gi·ªù, h√£y th·ª≠ s·ª©c v·ªõi minigame nh·ªè x√≠u m√† Ren l√†m ri√™ng cho b·∫°n nha~ üòö</p>
    <div class="button-container">
      <button class="game-button" onclick="showGame()">üé≤ Nh·∫•n ƒë·ªÉ b·∫Øt ƒë·∫ßu ch∆°i</button>
    </div>
  </div>

  <!-- MINIGAME -->
  <div class="section" id="minigame" style="display: none;">
    <h2 style="text-align:center;">üß† Minigame: L·∫≠t C·∫∑p ƒê√¥i</h2>
    <div class="game-board" id="gameBoard"></div>
  </div>

  <footer>
    ¬© 2025 Caffeine Clash. All rights reserved.
  </footer>

  <!-- Boing Sound -->
  <audio id="boing-sound" src="https://www.myinstants.com/media/sounds/boing.mp3"></audio>

  <script>
    const icons = ["matcha latte üçµ", "cafe ‚òï", "milk üç∂", "soda ü•§"];
    let board = [], flipped = [], locked = false;

    function shuffle(array) {
      return array.sort(() => Math.random() - 0.5);
    }

    function showGame() {
      document.getElementById("minigame").style.display = "block";
      initBoard();
      document.getElementById("minigame").scrollIntoView({ behavior: "smooth" });
    }

    function initBoard() {
      board = shuffle([...icons, ...icons]);
      const container = document.getElementById('gameBoard');
      container.innerHTML = '';
      flipped = [];
      board.forEach((text, index) => {
        const card = document.createElement('div');
        card.classList.add('card');
        card.dataset.index = index;

        card.innerHTML = `
          <div class="face front"></div>
          <div class="face back">${text}</div>
        `;
        card.addEventListener('click', () => handleFlip(card));
        container.appendChild(card);
      });
    }
      </script>
</body>
</html>
