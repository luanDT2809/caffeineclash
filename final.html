<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>CaffeineClash.com.vn</title>
  <style>
    body {
      margin: 0;
      font-family: "Segoe UI", sans-serif;
      background-color: #f5f0e6;
      color: #4e342e;
    }

    .header {
      padding: 20px;
      background-color: #d7ccc8;
      display: flex;
      justify-content: space-between;
      align-items: center;
    }

    .logo {
      font-weight: bold;
      font-size: 1.2rem;
    }

    .section {
      padding: 40px 20px;
    }

    .flex-row, .flex-row-reverse {
      display: flex;
      justify-content: space-between;
      align-items: center;
      gap: 30px;
      flex-wrap: wrap;
    }

    .flex-row-reverse {
      flex-direction: row-reverse;
    }

    .flex-text {
      flex: 1;
      font-size: 1.4rem;
      min-width: 250px;
    }

    .flex-img {
      flex: 1;
      min-width: 250px;
      max-width: 500px;
    }

    .flex-img img {
      width: 100%;
      border-radius: 12px;
      box-shadow: 0 4px 10px rgba(0,0,0,0.15);
      margin-top: 10px;
    }

    .button-container {
      text-align: center;
      margin-top: 40px;
    }

    .game-button {
      padding: 15px 30px;
      font-size: 1.1rem;
      border: none;
      border-radius: 8px;
      background-color: #a1887f;
      color: white;
      cursor: pointer;
      transition: 0.3s;
    }

    .game-button:hover {
      background-color: #8d6e63;
    }

    .game-board {
      display: grid;
      grid-template-columns: repeat(6, 120px);
      gap: 15px;
      justify-content: center;
      margin: 40px auto;
      perspective: 1000px;
    }

    .card {
      width: 100px;
      height: 100px;
      background-color: #a1887f;
      border-radius: 10px;
      transform-style: preserve-3d;
      transition: transform 0.6s;
      position: relative;
      cursor: pointer;
    }

    .card.flipped {
      transform: rotateY(180deg);
    }

    .face {
      position: absolute;
      width: 100%;
      height: 100%;
      backface-visibility: hidden;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 16px;
      border-radius: 10px;
    }

    .front {
      background-color: #a1887f;
    }

    .back {
      transform: rotateY(180deg);
      background-color: #fffde7;
      color: #4e342e;
      font-weight: bold;
    }

    footer {
      padding: 20px;
      text-align: center;
      font-size: 0.9rem;
      color: #795548;
    }
  </style>
</head>
<!-- Firebase Auth + Firestore Leaderboard -->
<script type="module">
  import { initializeApp } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js";
  import { getAuth, GoogleAuthProvider, signInWithPopup, onAuthStateChanged } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-auth.js";
  import { getFirestore, doc, getDoc, setDoc, updateDoc, collection, query, orderBy, limit, onSnapshot } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore.js";

  // Firebase config báº¡n cung cáº¥p
  const firebaseConfig = {
    apiKey: "AIzaSyCvzWN3TaOzVqfnmydlLAciY5Ps1NNA4-s",
    authDomain: "caffeineclash.firebaseapp.com",
    projectId: "caffeineclash",
    storageBucket: "caffeineclash.firebasestorage.app",
    messagingSenderId: "6327467073",
    appId: "1:6327467073:web:94a629f6d14a11aa01dac0",
    measurementId: "G-P87RYKDMDT"
  };

  // Init Firebase
  const app = initializeApp(firebaseConfig);
  const auth = getAuth(app);
  const db = getFirestore(app);

  // Táº¡o nÃºt Ä‘Äƒng nháº­p
  const loginBtn = document.createElement("button");
  loginBtn.className = "game-button";
  loginBtn.innerText = "ğŸ” ÄÄƒng nháº­p báº±ng Gmail";
  loginBtn.onclick = async () => {
    const provider = new GoogleAuthProvider();
    await signInWithPopup(auth, provider);
  };

  // GÃ¡n láº¡i nÃºt chÆ¡i cÅ©
  const playBtn = document.querySelector(".game-button");
  playBtn.style.display = "none";
  playBtn.id = "playBtn";

  // Táº¡o khu vá»±c leaderboard
  const leaderboardSection = document.createElement("div");
  leaderboardSection.className = "section";
  leaderboardSection.id = "leaderboardSection";
  leaderboardSection.style.display = "none";
  leaderboardSection.innerHTML = `
    <h2 style="text-align:center;">ğŸ† Báº£ng xáº¿p háº¡ng</h2>
    <ol id="leaderboard" style="font-size:1.2rem; text-align:center;"></ol>
  `;
  document.body.insertBefore(leaderboardSection, document.querySelector("footer"));

  // Gáº¯n login button vÃ o DOM
  document.querySelector(".button-container").prepend(loginBtn);

  let user = null;
  let userPoints = 0;

  // Sau khi Ä‘Äƒng nháº­p
  onAuthStateChanged(auth, async (currentUser) => {
    if (!currentUser) return;
    user = currentUser;
    loginBtn.style.display = "none";
    playBtn.style.display = "inline-block";
    leaderboardSection.style.display = "block";

    const userRef = doc(db, "users", user.uid);
    const snap = await getDoc(userRef);
    if (!snap.exists()) {
      await setDoc(userRef, { name: user.displayName, points: 0 });
    } else {
      userPoints = snap.data().points;
    }
    loadLeaderboard();
  });

  // Load top 10 ngÆ°á»i dÃ¹ng
  function loadLeaderboard() {
    const q = query(collection(db, "users"), orderBy("points", "desc"), limit(10));
    onSnapshot(q, (snapshot) => {
      const list = document.getElementById("leaderboard");
      list.innerHTML = "";
      snapshot.forEach((doc) => {
        const d = doc.data();
        list.innerHTML += `<li>${d.name}: ${d.points} Ä‘iá»ƒm</li>`;
      });
    });
  }

  // Báº¯t Ä‘áº§u game khi Ä‘Ã£ Ä‘Äƒng nháº­p
  document.getElementById("playBtn").onclick = () => {
    document.getElementById("minigame").style.display = "block";
    initBoard();
    document.getElementById("minigame").scrollIntoView({ behavior: "smooth" });
  };

  // Cáº­p nháº­t biá»ƒu tÆ°á»£ng má»›i
  const icons = [
    "matcha latte ğŸµ", "cafe â˜•", "milk ğŸ¶", "soda ğŸ¥¤",
    "Ren chiáº¿n ğŸ˜¤", "Ren ná»• nÃ£o ğŸ¤¯", "Ren Luxury ğŸ˜", "Ren kÃªu ngáº¡o ğŸ˜", "game ğŸ®", "card ğŸ´", "Ren khÃ³c ğŸ˜­", "Ren chill ğŸ˜—"
  ];
  let board = [], flipped = [], locked = false;

  function shuffle(array) {
    return array.sort(() => Math.random() - 0.5);
  }

  function initBoard() {
    board = shuffle([...icons, ...icons]);
    const container = document.getElementById('gameBoard');
    container.innerHTML = '';
    flipped = [];
    board.forEach((text, index) => {
      const card = document.createElement('div');
      card.classList.add('card');
      card.dataset.index = index;

      card.innerHTML = `
        <div class="face front"></div>
        <div class="face back">${text}</div>
      `;
      card.addEventListener('click', () => handleFlip(card));
      container.appendChild(card);
    });
  }

  async function handleScore(pointsEarned) {
  userPoints += pointsEarned;
  console.log(`ğŸ’¾ Cá»™ng ${pointsEarned} Ä‘iá»ƒm â†’ Tá»•ng: ${userPoints}`);

  try {
    await updateDoc(doc(db, "users", user.uid), { points: userPoints });
    alert(`âœ… Báº¡n nháº­n Ä‘Æ°á»£c ${pointsEarned} Ä‘iá»ƒm! Tá»•ng Ä‘iá»ƒm: ${userPoints}`);
    loadLeaderboard();
  } catch (err) {
    console.error("âŒ Lá»—i khi cáº­p nháº­t Ä‘iá»ƒm:", err);
    alert("âŒ Lá»—i khi lÆ°u Ä‘iá»ƒm vÃ o há»‡ thá»‘ng! Xem console.");
  }
}

  function handleFlip(card) {
  if (locked || card.classList.contains('flipped')) return;
  card.classList.add('flipped');
  flipped.push(card);

  if (flipped.length === 2) {
    locked = true;
    const [a, b] = flipped;
    const valA = a.querySelector('.back').textContent;
    const valB = b.querySelector('.back').textContent;

    if (valA === valB) {
      flipped = [];
      locked = false;

      // Náº¿u láº­t háº¿t táº¥t cáº£ cáº·p Ä‘Ãºng
      if (document.querySelectorAll('.card.flipped').length === board.length) {
        handleScore(10);
        setTimeout(() => {
          if (confirm("ğŸ‰ Báº¡n Ä‘Ã£ tháº¯ng! ChÆ¡i láº¡i?")) {
            initBoard(); // chá»‰ shuffle láº¡i khi tháº¯ng
          }
        }, 500);
      }

    } else {
      setTimeout(() => {
        document.getElementById("boing-sound").play();

        // â—â— Láº­t Ãºp toÃ n bá»™ cÃ¡c tháº» (ká»ƒ cáº£ Ä‘Ãºng)
        document.querySelectorAll('.card').forEach(c => c.classList.remove('flipped'));

        const correct = document.querySelectorAll('.card.flipped').length; // lÃºc nÃ y = 0

        setTimeout(() => {
          // Cháº¥m Ä‘iá»ƒm theo yÃªu cáº§u
          if (correct >= 8) {
            handleScore(1);
          } else {
            handleScore(0);
          }
          flipped = [];
          locked = false;
        }, 300);
      }, 800);
    }
  }
}

</script>

<body>

  <div class="header">
    <div class="logo">CaffeineClash.com.vn â˜•ğŸ®</div>
  </div>

  <!-- SECTION 1 -->
  <div class="section flex-row">
    <div class="flex-text">
      <h2>â˜• Welcome to Caffeine Clash!</h2>
<p>
  áº¨n mÃ¬nh giá»¯a lÃ²ng thÃ nh phá»‘ táº¥p náº­p, <strong>Caffeine Clash</strong> khÃ´ng chá»‰ lÃ  má»™t quÃ¡n cafÃ©,  
  mÃ  lÃ  nÆ¡i há»™i tá»¥ cá»§a nhá»¯ng tÃ¢m há»“n yÃªu tá»‘c Ä‘á»™, trÃ­ tuá»‡ vÃ  caffeine.  
  Táº¡i Ä‘Ã¢y, má»—i ngá»¥m latte lÃ  má»™t láº§n tÄƒng mana, vÃ  má»—i bÃ n Ä‘áº¥u bÃ i lÃ  má»™t vÅ© trá»¥ chiáº¿n thuáº­t Ä‘ang chá» Ä‘Æ°á»£c khai má»Ÿ.
</p>
<p>
  DÃ¹ báº¡n lÃ  ngÆ°á»i má»›i chá»‰ vá»«a biáº¿t Ä‘áº¿n â€œtapping manaâ€ hay lÃ  chiáº¿n tháº§n combo 999 hit,  
  chÃºng tÃ´i cÃ³ khÃ´ng gian dÃ nh riÃªng cho báº¡n: nÆ¡i ly cÃ  phÃª nÃ³ng vÃ  nhá»¯ng tráº­n Ä‘áº¥u náº£y lá»­a hÃ²a vÃ o nhau nhÆ° má»™t nghá»‡ thuáº­t.
</p>
    </div>
    <div class="flex-img">
      <img src="so-1.jpg.jpg" alt="so 1">
    </div>
  </div>

  <!-- SECTION 2 -->
  <div class="section flex-row-reverse">
    <div class="flex-text">
      <h2>ğŸ® Má»™t sá»± káº¿t há»£p Ä‘á»™c Ä‘Ã¡o</h2>
<p>
  <strong>ChÃºng tÃ´i tin ráº±ng khÃ´ng gian giáº£i trÃ­ hiá»‡n Ä‘áº¡i khÃ´ng cáº§n pháº£i tÃ¡ch biá»‡t giá»¯a chÆ¡i vÃ  chill.</strong>  
  VÃ¬ váº­y, Caffeine Clash táº¡o ra má»™t há»‡ sinh thÃ¡i nÆ¡i game thá»§ cÃ³ thá»ƒ vá»«a nhÃ¢m nhi má»™t ly soda mÃ¡t láº¡nh,  
  vá»«a â€œcÃ  khá»‹aâ€ nhau trÃªn mÃ¡y thÃ¹ng Ä‘á»‘i khÃ¡ng vá»›i báº¡n bÃ¨.
</p>

<p>
  Tá»« tháº» bÃ i láº¥p lÃ¡nh, bÃ n tay shuffle Ä‘iÃªu luyá»‡n, Ä‘áº¿n cÃº Ä‘Ã¡ roundhouse vÃ´ cá»±c trong Street Fighterâ€¦  
  táº¥t cáº£ Ä‘á»u diá»…n ra táº¡i má»™t nÆ¡i â€” nÆ¡i mÃ  má»—i chiáº¿n tháº¯ng Ä‘á»u Ä‘Æ°á»£c chÃºc má»«ng báº±ng... má»™t shot espresso.  
  Báº¡n Ä‘Ã£ sáºµn sÃ ng lÃªn level chÆ°a?
</p>

<p>
  ğŸ’¥ <strong>Sáº¯p tá»›i khi Ä‘i vÃ o váº­n hÃ nh chÃ­nh thá»©c, Caffeine Clash sáº½ tá»• chá»©c sá»± kiá»‡n má»Ÿ mÃ n hoÃ nh trÃ¡ng mang tÃªn:</strong>  
  <em>**â€œCaffeine Showdown Vol.1â€**</em> â€” má»™t giáº£i Ä‘áº¥u káº¿t há»£p giá»¯a **card game chiáº¿n thuáº­t** vÃ  **fighting game arcade** láº§n Ä‘áº§u tiÃªn xuáº¥t hiá»‡n táº¡i thÃ nh phá»‘!
</p>

<p>
  NgÆ°á»i chÆ¡i sáº½ vá»«a thi Ä‘áº¥u Magic: The Gathering, PokÃ©mon TCG, hoáº·c Yugiohâ€¦  
  rá»“i chuyá»ƒn sang combo Zangief vÃ  Ryu á»Ÿ khu vá»±c mÃ¡y thÃ¹ng Ä‘á»‘i khÃ¡ng cá»±c chÃ¡y!  
  Má»—i chiáº¿n tháº¯ng á»Ÿ tá»«ng vÃ²ng sáº½ Ä‘Æ°á»£c cá»™ng Ä‘iá»ƒm tÃ­ch lÅ©y Ä‘á»ƒ xáº¿p háº¡ng tranh cÃºp **Champion of Caffeine** ğŸ†
</p>

<p>
  ğŸ VÃ  táº¥t nhiÃªn, khÃ´ng thá»ƒ thiáº¿u cÃ¡c pháº§n thÆ°á»Ÿng: Ã¡o Ä‘áº¥u Ä‘á»™c quyá»n, ly sá»© in tÃªn vÃ´ Ä‘á»‹ch, vÃ  cáº£...  
  **"Phiáº¿u vÄ©nh viá»…n uá»‘ng cafe miá»…n phÃ­ 1 nÄƒm"** cho quÃ¡n quÃ¢n toÃ n nÄƒng! ğŸ˜±â˜•  
  (*Ren cÃ²n gá»£i Ã½: ai cosplay Bartender hoáº·c nhÃ¢n váº­t trong game sáº½ Ä‘Æ°á»£c buff Ä‘iá»ƒm thÆ°á»Ÿng nÃ¨ ğŸ˜†*)
</p>
    </div>
    <div class="flex-img">
      <img src="so-2.jpg.jpg" alt="so 2">
      <img src="so-3.jpg.jpg" alt="so 3">
    </div>
  </div>

  <!-- GAME INTRO -->
  <div class="section">
    <h3 style="text-align: center;">ğŸ‰ Cáº£m Æ¡n báº¡n Ä‘Ã£ ghÃ© qua Caffeine Clash!</h3>
    <p style="text-align: center;">VÃ  bÃ¢y giá», hÃ£y thá»­ sá»©c vá»›i minigame nhá» xÃ­u mÃ  Ren lÃ m riÃªng cho báº¡n nha~ ğŸ˜š</p>
    <div class="button-container">
      <button class="game-button" onclick="showGame()">ğŸ² Nháº¥n Ä‘á»ƒ báº¯t Ä‘áº§u chÆ¡i</button>
    </div>
  </div>

  <!-- MINIGAME -->
  <div class="section" id="minigame" style="display: none;">
    <h2 style="text-align:center;">ğŸ§  Minigame: Láº­t Cáº·p ÄÃ´i</h2>
    <div class="game-board" id="gameBoard"></div>
  </div>

  <footer>
    Â© 2025 Caffeine Clash. All rights reserved.
  </footer>

  <!-- Boing Sound -->
  <audio id="boing-sound" src="https://www.myinstants.com/media/sounds/boing.mp3"></audio>

  <script>
    const icons = ["matcha latte ğŸµ", "cafe â˜•", "milk ğŸ¶", "soda ğŸ¥¤"];
    let board = [], flipped = [], locked = false;

    function shuffle(array) {
      return array.sort(() => Math.random() - 0.5);
    }

    function showGame() {
      document.getElementById("minigame").style.display = "block";
      initBoard();
      document.getElementById("minigame").scrollIntoView({ behavior: "smooth" });
    }

    function initBoard() {
      board = shuffle([...icons, ...icons]);
      const container = document.getElementById('gameBoard');
      container.innerHTML = '';
      flipped = [];
      board.forEach((text, index) => {
        const card = document.createElement('div');
        card.classList.add('card');
        card.dataset.index = index;

        card.innerHTML = `
          <div class="face front"></div>
          <div class="face back">${text}</div>
        `;
        card.addEventListener('click', () => handleFlip(card));
        container.appendChild(card);
      });
    }
      </script>
</body>
</html>
